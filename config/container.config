%% Container deployment configuration for ErlVectorDB
%% This configuration is optimized for Docker and Kubernetes deployments
[
    {erlvectordb, [
        % Network configuration for containers
        {mcp_port, 8080},
        {oauth_port, 8081},
        {rest_api_port, 8082},
        {rest_api_enabled, true},
        
        % Container Mode Configuration
        {container_mode, true},
        {port_config, #{
            mcp_server => #{
                preferred_port => 8080,
                port_range => {8080, 8090},
                bind_interface => "0.0.0.0",  % Bind to all interfaces for container access
                required => true,
                startup_order => 1,
                health_check_path => "/health",
                container_mode => true
            },
            oauth_server => #{
                preferred_port => 8081,
                port_range => {8081, 8091},
                bind_interface => "0.0.0.0",
                required => true,
                startup_order => 2,
                health_check_path => "/oauth/health",
                container_mode => true
            },
            rest_api_server => #{
                preferred_port => 8082,
                port_range => {8082, 8092},
                bind_interface => "0.0.0.0",
                required => true,
                startup_order => 3,
                health_check_path => "/api/health",
                container_mode => true
            }
        }},
        
        % Container-specific settings
        {container_config, #{
            bind_interface => "0.0.0.0",
            health_check_enabled => true,
            graceful_shutdown_timeout => 30000,  % 30 seconds
            port_mapping_logging => true
        }},
        
        % Authentication
        {oauth_enabled, true},
        {oauth_token_endpoint, "http://0.0.0.0:8081/oauth/token"},
        {create_default_client, true},
        {default_client_id, <<"admin">>},
        {default_client_secret, <<"admin_secret_2024">>},
        {token_lifetime, 3600000},
        {refresh_token_lifetime, 86400000},
        
        % Clustering configuration for container orchestration
        {cluster_enabled, false},  % Enable via environment variables
        {node_name, 'erlvectordb@container'},
        {cluster_cookie, erlvectordb_cluster},
        {replication_factor, 2},
        {heartbeat_interval, 5000},
        
        % Compression configuration
        {compression_enabled, true},
        {compression_algorithm, quantization_8bit},
        
        % Storage configuration for containers
        {max_vector_stores, 100},
        {default_index_type, flat},
        {persistence_enabled, true},
        {persistence_dir, "/data"},  % Use container volume mount
        {backup_dir, "/backups"},    % Use container volume mount
        {sync_interval, 30000},
        {auto_backup_enabled, false},
        {auto_backup_interval, 3600000}
    ]},
    {kernel, [
        {logger_level, info},
        {logger, [
            {handler, default, logger_std_h,
                #{config => #{type => standard_io},
                  formatter => {logger_formatter, #{}}}}
        ]}
    ]}
].